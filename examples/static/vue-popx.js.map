{"version":3,"file":"vue-popx.js","sources":["../../src/Poptype.js","../../src/Static.js","../../src/PopBase.js","../../src/PopCom.js","../../src/PopParse.js","../../src/main.js"],"sourcesContent":["export default {\n  checkPopper (popper) {\n    let type = ''\n    // console.log(popper)\n    if (popper instanceof HTMLElement) {\n      type = 'html'\n    } else {\n      switch ((typeof popper).toLowerCase()) {\n        case 'object':\n          let if1 = popper.hasOwnProperty('render') && popper.hasOwnProperty('staticRenderFns')\n          let if2 = popper.hasOwnProperty('template') && (typeof popper.template).toLowerCase() === 'string'\n          if (!if2 && popper.template) throw new Error('The template must be a string')\n          if (if1 || if2) type = 'component'\n          break\n        case 'string':\n          type = 'string'\n          break\n      }\n    }\n    return type\n  }\n}\n","// 弹窗管理\nclass PopManage {\n  constructor () {\n    this._pops = {}\n  }\n  add (ins) {\n    this._pops[ins.uuid] = ins\n    return ins.uuid\n  }\n  popins (uid) {\n    return this._pops[uid]\n  }\n  remove (uid) {\n    delete this._pops[uid]\n  }\n  close (uid) {\n    if (uid) {\n      this.popins(uid).close()\n      this.remove(uid)\n    } else {\n      for (let key in this._pops) {\n        this._pops[key].close()\n        this.remove(key)\n      }\n    }\n  }\n}\n\nexport default {\n  manage: new PopManage()\n}\n","import Popper from 'popper.js'\nimport Static from './Static'\n\nexport default class {\n  constructor (opts, vm) {\n    this._opts = opts\n    this._static = Static\n    this._vm = vm\n    this._pvm = null\n    this.type = null\n    this.event = {}\n    this.uuid = Math.random().toString(16).substr(-4) + '-' + Math.random().toString(16).substr(-4) + '-' + Math.random().toString(16).substr(-4) + '-' + Math.random().toString(16).substr(-4)\n    this.init()\n  }\n\n  /**\n   * 初始化\n   */\n  init () {}\n\n  /**\n   * 初始化完成\n   */\n  initComplete () {\n    this._pvm['$parent'] = this._vm.$root\n    document.body.appendChild(this._pvm.$el)\n    this.popins = new Popper(this.ref, this.popper, this._opts.options)\n    if (this.ref.isFixed) {\n      let style = Static.Style\n      for (let key in style) {\n        if (style.hasOwnProperty(key)) {\n          this.popper.style[key] = style[key]\n          if (key === 'zIndex') {\n            style[key] ++\n          }\n        }\n      }\n    }\n    this._pvm && this.initEvent()\n  }\n\n  /**\n   * 初始化事件\n   */\n  initEvent () {\n    this._pvm.$on('close', d => {\n      if (this._opts.callback) {\n        this._opts.callback({\n          type: 'close',\n          payload: d,\n          next: this._destroy.bind(this)\n        })\n      } else {\n        this._destroy()\n      }\n    })\n  }\n\n  /**\n   * 销毁\n   * @private\n   */\n  _destroy () {\n    this.popins.destroy()\n    this._pvm.$el.remove()\n  }\n\n  /**\n   * 关闭弹窗\n   */\n  close () {\n    this._pvm.$emit('close')\n  }\n\n  /**\n   * 更新弹窗\n   */\n  update () {\n    this.popins.update()\n  }\n\n  /**\n   * 获取参照\n   * @returns {Object}\n   */\n  get ref () {\n    return this._opts.reference\n  }\n\n  /**\n   * 获取弹窗HTMLELEMENT\n   */\n  get popper () {}\n}\n","import Base from './PopBase'\n\nclass PopCom extends Base {\n  init () {\n    let TempC = this._static.Vue.extend(this._opts.popper)\n    // 赋值popper vm实例\n    this._pvm = new TempC()\n    this._pvm.$mount()\n    if (this._pvm.popxdata) this._pvm.popxdata = this._opts.data\n    this._pvm.$el.setAttribute('data-uid', this.uuid)\n    this.initComplete()\n  }\n  get popper () {\n    return this._pvm.$el\n  }\n}\n\nexport default PopCom\n","import Poptype from './Poptype'\nimport PopCom from './PopCom'\nimport Static from './Static'\n// 解析类型映射\nconst MAP = {\n  'component': PopCom\n}\n\nexport default function (opts, vm) {\n  let type = Poptype.checkPopper(opts.popper)\n  // console.log(type)\n  let Constr = MAP[type]\n  if (!Constr) throw new Error('没有匹配的弹窗解析')\n  let tempPop = new Constr(opts, vm)\n  tempPop.type = type\n  return Static.manage.add(tempPop)\n}\n","import PopParse from './PopParse'\nimport Static from './Static'\n\nconst DEFAULT = {\n  reference: {\n    getBoundingClientRect: () => ({\n      left: 0, top: 0, width: 0, height: 0\n    }),\n    clientWidth: 0,\n    clientHeight: 0,\n    isFixed: true\n  },\n  popper: null,\n  options: {\n    placement: 'top'\n  },\n  data: {}\n}\nlet rvm = null\nconst func = function (opts) {\n  opts = Object.assign({}, DEFAULT, opts)\n  if (!opts.popper) throw new Error('popper not define')\n  if (!rvm) rvm = this.$root\n  if (opts.reference.isFixed) {\n    opts.options.modifiers = {\n      applyStyle: { enabled: false }\n    }\n  }\n  return PopParse(opts, this)\n}\n\nfunc.close = function (uid) {\n  if (Static.manage) Static.manage.close(uid)\n}\n\nfunc.manage = Static.manage\n\nfunc.destroy = function () {\n  delete func.manage\n  delete Static.Vue.prototype.$Popx\n}\n\n/**\n * popper样式\n * only isFixed is true\n */\nfunc.style = {\n  zIndex: 999\n}\n\n// func.fire = function (uid, type, payload) {\n//   console.log(rvm.popx.popins(uid))\n// }\n\nexport default {\n  install (Vue) {\n    Static.Vue = Vue\n    Static.Style = func.style\n    Vue.prototype.$Popx = func\n  }\n}\n"],"names":["let","this","const"],"mappings":"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"}